name: ğŸš€ è‡ªåŠ¨éƒ¨ç½²åˆ°Streamlit Cloud

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

env:
  PYTHON_VERSION: '3.9'

jobs:
  test:
    name: ğŸ§ª æµ‹è¯•ä»£ç 
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
    
    - name: ğŸ è®¾ç½®Pythonç¯å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        cache: 'pip'
    
    - name: ğŸ“¦ å®‰è£…ä¾èµ–
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    - name: âœ… è¿è¡Œæµ‹è¯•
      run: |
        python tests/test_basic.py
    
    - name: ğŸ” ä»£ç è´¨é‡æ£€æŸ¥
      run: |
        python -c "import main; print('âœ… main.py è¯­æ³•æ£€æŸ¥é€šè¿‡')"
        python -c "import src.screening.screener; print('âœ… ç­›é€‰æ¨¡å—æ£€æŸ¥é€šè¿‡')"
        python -c "import src.risk_management.risk_manager; print('âœ… é£é™©ç®¡ç†æ¨¡å—æ£€æŸ¥é€šè¿‡')"
  
  deploy-notification:
    name: ğŸ“¢ éƒ¨ç½²é€šçŸ¥
    runs-on: ubuntu-latest
    needs: test
    if: github.ref == 'refs/heads/main' && github.event_name == 'push'
    
    steps:
    - name: ğŸ‰ éƒ¨ç½²æˆåŠŸé€šçŸ¥
      run: |
        echo "ğŸš€ ä»£ç å·²æ¨é€åˆ°GitHubä¸»åˆ†æ”¯"
        echo "â³ Streamlit Cloudå°†åœ¨1-2åˆ†é’Ÿå†…è‡ªåŠ¨éƒ¨ç½²"
        echo "ğŸŒ éƒ¨ç½²å®Œæˆåè¯·è®¿é—®æ‚¨çš„åº”ç”¨URLæŸ¥çœ‹æ›´æ–°"